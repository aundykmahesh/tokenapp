(this.webpackJsonptokenapp=this.webpackJsonptokenapp||[]).push([[0],{326:function(e,t,n){},562:function(e,t,n){"use strict";n.r(t),n.d(t,"history",(function(){return te}));var r=n(0),a=n(45),o=n.n(a),s=(n(324),n(325),n(326),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,583)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),o(e),s(e)}))}),c=n(37),i=n(18),u=n(13),l=n(14),d=n(16),j=function(){function e(){var t=this;Object(u.a)(this,e),this.error=null,this.token=window.localStorage.getItem("jwt"),this.apploaded=!1,this.setServerError=function(e){t.error=e},this.setToken=function(e){t.token=e},this.setAppLoaded=function(){t.apploaded=!0},Object(d.d)(this),Object(d.g)((function(){return t.token}),(function(e){e?window.localStorage.setItem("jwt",e):window.localStorage.removeItem("jwt")}))}return Object(l.a)(e,[{key:"formatDate",value:function(e){var t=new Date(e),n=""+(t.getMonth()+1),r=""+t.getDate(),a=t.getFullYear();return n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),[r,n,a].join("-")}},{key:"AddDays",value:function(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n}}]),e}(),b=n(24),h=n.n(b),f=n(52),p=n(89),g=n.n(p),k=n(124);g.a.defaults.baseURL="http://localhost:5001/api";g.a.interceptors.request.use((function(e){return T.commonstore.token&&(e.headers.Authorization="Bearer ".concat(T.commonstore.token)),e})),g.a.interceptors.response.use(function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=3;break;case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){var t=e.response,n=t.data,r=t.status,a=t.config;switch(r){case 400:if("string"===typeof n&&k.b.error(n),"get"===a.method&&n.errors.hasOwnProperty("id")&&te.push("/not-found"),n.errors){var o=[];for(var s in n.errors)n.errors[s]&&o.push(n.errors[s]);throw o.flat()}break;case 401:k.b.error("Unauthorized request");break;case 404:te.push("/not-found");break;case 500:k.b.error("server not found"),T.commonstore.setServerError(n),te.push("/server-error")}}));var x=function(e){return e.data},O=function(e){return g.a.get(e).then(x)},m=function(e,t){return g.a.post(e,t).then(x)},v={Tokens:{list:function(){return O("/token/tokens")},generatetoken:function(e){return m("/token/generate",e)},disabletoken:function(e){return m("/token/disabletoken?tokenid=".concat(e),e)},enabletoken:function(e){return m("/token/enabletoken?tokenid=".concat(e),e)},validatetoken:function(e){return m("/token/validate",e)}},Account:{current:function(){return O("/accounts")},login:function(e){return m("/accounts/login",e)}}},S=function(){function e(){var t=this;Object(u.a)(this,e),this.user=null,this.logout=function(){T.commonstore.setToken(null),window.localStorage.removeItem("jwt"),t.user=null,te.push("/")},this.getUser=Object(f.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Account.current();case 3:n=e.sent,Object(d.h)((function(){return t.user=n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Object(d.d)(this)}return Object(l.a)(e,[{key:"isLoggedIn",get:function(){var e;return!!(null===(e=this.user)||void 0===e?void 0:e.displayName)}},{key:"login",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Account.login(t);case 3:n=e.sent,T.commonstore.setToken(n.token),Object(d.h)((function(){return r.user=n})),te.push("/tokens"),console.log(n),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),T={tokenstore:new function e(){var t=this;Object(u.a)(this,e),this.loading=!1,this.submitting=!1,this.tokens=[],this.paginatedTokens=[],this.setLoadingStatus=function(e){t.loading=e},this.setSubmittingStatus=function(e){t.submitting=e},this.loadPaginatedTokens=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=t.tokens.length){e.next=3;break}return e.next=3,t.loadAllTokens();case 3:t.paginatedTokens=t.tokens.slice(10*(n-1),10*n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.loadAllTokens=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoadingStatus(!0),e.prev=1,e.next=4,v.Tokens.list().then((function(e){t.tokens=[],e.forEach((function(e){t.setToken(e)})),t.setLoadingStatus(!1)}));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0),t.setLoadingStatus(!1);case 10:case"end":return e.stop()}}),e,null,[[1,6]])}))),this.generateToken=function(){var e=Object(f.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoadingStatus(!0),e.prev=1,r={appurl:n},e.next=5,v.Tokens.generatetoken(r).then((function(e){t.setToken(e)}));case 5:t.setLoadingStatus(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),t.setLoadingStatus(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.setToken=function(e){e.status=t.setTokenStatus(e.status),t.tokens.push(e)},this.disableToken=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setSubmittingStatus(!0),e.prev=1,e.next=4,v.Tokens.disabletoken(n);case 4:t.tokens.find((function(e){return e.guid===n})).status=t.setTokenStatus("2"),t.setSubmittingStatus(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),t.setSubmittingStatus(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.enableToken=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setSubmittingStatus(!0),e.prev=1,e.next=4,v.Tokens.enabletoken(n);case 4:t.tokens.find((function(e){return e.guid===n})).status=t.setTokenStatus("0"),t.setSubmittingStatus(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),t.setSubmittingStatus(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.setTokenStatus=function(e){return"0"==e?"Enabled":"1"==e?"Expired":"Disabled"},Object(d.d)(this)},userstore:new S,commonstore:new j},w=Object(r.createContext)(T);function y(){return Object(r.useContext)(w)}var C=n(574),L=n(46),D=n(81),E=n(581),A=n(582),I=n(580),F=n(4),P=Object(L.a)((function(){var e=y().userstore;return Object(F.jsx)(E.a,{inverted:!0,textAlign:"center",vertical:!0,className:"masthead",children:Object(F.jsxs)(C.a,{text:!0,children:[Object(F.jsx)(A.a,{as:"h1",inverted:!0,children:"Token App"}),e.isLoggedIn?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(A.a,{as:"h2",inverted:!0,content:"Welcome to Token app"}),Object(F.jsx)(I.a,{as:D.a,to:"/tokens",size:"huge",inverted:!0,children:"Go to Tokens Dashboard!"})]}):Object(F.jsx)(I.a,{as:D.a,to:"/login",size:"huge",inverted:!0,children:"Login!"})]})})})),R=n(67),U=n(189),H=n(227),B=n(64),q=n(303),z=n.n(q);function N(e){var t=Object(R.d)(e.name),n=Object(B.a)(t,2),r=n[0],a=n[1];return Object(F.jsxs)(z.a.Field,{error:a.touched&&!!a.error,children:[Object(F.jsx)("label",{children:e.label}),Object(F.jsx)("input",Object(H.a)(Object(H.a)({},r),e)),a.touched&&a.error?Object(F.jsx)(U.a,{basic:!0,color:"red",children:a.error}):null]})}var _=Object(L.a)((function(){var e=y().userstore;return Object(F.jsx)(R.c,{initialValues:{email:"",password:"",error:null},onSubmit:function(t,n){var r=n.setErrors;return e.login(t).catch((function(e){return r({error:"Invalid login or password"})}))},children:function(e){var t=e.handleSubmit,n=e.isSubmitting,r=e.errors;return Object(F.jsxs)(R.b,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(F.jsx)(N,{name:"email",placeholder:"Email",color:r.error&&"red"}),Object(F.jsx)(N,{name:"password",placeholder:"Password",type:"password"}),Object(F.jsx)(R.a,{name:"error",render:function(){return Object(F.jsx)(U.a,{style:{marginBottom:10},basic:!0,color:"red",content:r.error})}}),Object(F.jsx)(I.a,{loading:n,positive:!0,content:"Login",type:"submit",fluid:!0})]})}})})),G=n(578),J=n(579),V=n(575);function M(e){var t=e.inverted,n=void 0===t||t,r=e.content,a=void 0===r?"Loading...":r;return Object(F.jsx)(J.a,{active:!0,inverted:n,children:Object(F.jsx)(V.a,{content:a})})}var W=n(576),Y=n(226);function K(){var e=y().tokenstore.generateToken,t=Y.a({url:Y.b().required("The URL is required").url("Should be of proper URL format")});return Object(F.jsx)(R.c,{initialValues:{url:"",error:null},validationSchema:t,onSubmit:function(t,n){var r=n.setErrors;return e(t.url).catch((function(e){return r({error:"Invalid URL"})}))},children:function(e){var t=e.handleSubmit,n=e.isSubmitting,r=e.errors;return Object(F.jsxs)(W.a,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(F.jsx)(N,{name:"url",placeholder:"URL",color:r.error&&"red"}),Object(F.jsx)(R.a,{name:"error",render:function(){return Object(F.jsx)(U.a,{style:{marginBottom:10},basic:!0,color:"red",content:r.error})}}),Object(F.jsx)(I.a,{loading:n,positive:!0,content:"Create Token",type:"submit",fluid:!0})]})}})}var Q=n(577),X=Object(L.a)((function(e){var t=e.tokenarranylength,n=y().tokenstore;function r(e){n.loadPaginatedTokens(parseInt(e.currentTarget.innerText))}var a=t/10;t%10>0&&(a+=1);var o=0,s=[];for(o=1;o<=a;o++){s.push(Object(F.jsx)(Q.a.Item,{as:"a",name:o.toString(),onClick:function(e){r(e)},children:o},o))}return Object(F.jsx)(Q.a,{floated:"right",pagination:!0,children:s})})),Z=Object(L.a)((function(){var e=y(),t=e.tokenstore,n=e.userstore,a=e.commonstore,o=(t.loadAllTokens,t.paginatedTokens),s=t.disableToken,c=t.submitting,i=n.user,u=Object(r.useState)(""),l=Object(B.a)(u,2),d=l[0],j=l[1];if(Object(r.useEffect)((function(){t.loadPaginatedTokens(1)}),[t.loadPaginatedTokens]),null==i&&te.push("/"),t.loading)return Object(F.jsx)(M,{content:"Loading app......"});function b(e,n){if(j(e.currentTarget.name),"Enable Token"==e.currentTarget.innerText){var r="btnenable_".length;t.enableToken(n.substring(r))}else s(n)}return Object(F.jsxs)(E.a.Group,{children:[Object(F.jsx)(E.a,{children:Object(F.jsx)(K,{})}),Object(F.jsx)(E.a,{children:Object(F.jsxs)(G.a,{celled:!0,children:[Object(F.jsx)(G.a.Header,{children:Object(F.jsxs)(G.a.Row,{children:[Object(F.jsx)(G.a.HeaderCell,{children:"URL"}),Object(F.jsx)(G.a.HeaderCell,{children:"Token"}),Object(F.jsx)(G.a.HeaderCell,{children:"Created Date"}),Object(F.jsx)(G.a.HeaderCell,{children:"Expiry Date"}),Object(F.jsx)(G.a.HeaderCell,{children:"Status"}),Object(F.jsx)(G.a.HeaderCell,{children:"Action"})]})}),Object(F.jsx)(G.a.Body,{children:Object(F.jsx)(F.Fragment,{children:o.map((function(e){return Object(F.jsxs)(G.a.Row,{children:[Object(F.jsx)(G.a.Cell,{children:e.appUrl}),Object(F.jsx)(G.a.Cell,{children:e.tokenString}),Object(F.jsx)(G.a.Cell,{children:a.formatDate(e.createdDate.toString())}),Object(F.jsx)(G.a.Cell,{children:a.formatDate(a.AddDays(e.createdDate,7).toString())}),Object(F.jsx)(G.a.Cell,{children:e.status}),Object(F.jsxs)(G.a.Cell,{children:[Object(F.jsx)(I.a,{onClick:function(t){b(t,"btnenable_".concat(e.guid))},name:"btnenable_".concat(e.guid),loading:c&&d==="btnenable_".concat(e.guid),disabled:"Enabled"==e.status,floated:"right",content:"Enable Token",color:"red"}),Object(F.jsx)(I.a,{onClick:function(t){b(t,e.guid)},name:e.guid,loading:c&&d===e.guid,disabled:"Enabled"!=e.status,floated:"right",content:"Disable Token",color:"red"})]})]},e.guid)}))})}),Object(F.jsx)(G.a.Footer,{children:Object(F.jsx)(G.a.Row,{children:Object(F.jsx)(G.a.HeaderCell,{colSpan:"6",children:Object(F.jsx)(X,{tokenarranylength:t.tokens.length})})})})]})})]})})),$=Object(L.a)((function(){var e=y().userstore;return Object(F.jsx)(Q.a,{inverted:!0,fixed:"top",children:Object(F.jsxs)(C.a,{children:[Object(F.jsx)(Q.a.Item,{as:D.b,to:"/",exact:!0,children:Object(F.jsx)("img",{src:"/assets/logo.png",alt:"logo",style:{marginRight:"10px"}})}),Object(F.jsx)(Q.a.Item,{as:D.b,to:"/tokens",exact:!0,name:"Tokens"}),e.user&&Object(F.jsx)(Q.a.Item,{position:"right",children:Object(F.jsx)(I.a,{positive:!0,onClick:e.logout,content:"Logout"})})]})})}));var ee=Object(L.a)((function(){var e=y(),t=e.userstore,n=e.commonstore;return Object(r.useEffect)((function(){n.token?t.getUser().finally((function(){return n.setAppLoaded()})):n.setAppLoaded()}),[n,t]),Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(k.a,{position:"bottom-right",hideProgressBar:!0}),Object(F.jsx)(i.a,{exact:!0,path:"/",component:P}),Object(F.jsx)(i.a,{path:"/(.+)",render:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)($,{}),Object(F.jsx)(C.a,{style:{marginTop:"7em"},children:Object(F.jsxs)(i.c,{children:[Object(F.jsx)(i.a,{exact:!0,path:"/tokens",component:Z}),Object(F.jsx)(i.a,{path:"/login",component:_})]})})]})}})]})})),te=Object(c.a)();o.a.render(Object(F.jsx)(w.Provider,{value:T,children:Object(F.jsx)(i.b,{history:te,children:Object(F.jsx)(ee,{})})}),document.getElementById("root")),s()}},[[562,1,2]]]);
//# sourceMappingURL=main.018056bf.chunk.js.map